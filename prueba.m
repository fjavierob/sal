%
% Francisco Javier Ortiz Bonilla
% Planificación y Operación de Redes
%

%% Script para probar la función sal.
clear all, close all

% V nodos posibles de núcleo.
V = 8;

% A nodos de acceso.
A = 20; 

% Demandas: Origen, Destino, Cantidad de demanda
h = [1  2  6; ...
     20 3  6; ...
     5  4  8; ...
     6  7  9; ...
     8  9  4; ...
     10 12 5; ...
     11 13 6; ...
     14 15 3; ...
     16 18 4; ...
     17 19 5;];  

% Límite de profundidad del algoritmo: Trayectos de hasta M nodos.
M = 4; % Límite profundidad

% Costes fijos de los nodos de núcleo.
vCostes = [6 5 2 1 7 6 5 4];
% vCostes = ones(1,V);

% Límite de enlaces para cada nodo de núcleo.
Gv		= [3 3 3 4 3 6 6 7];

% Parámetro q
q 		= 0.6;

% Número máximo de iteraciones
N 		= 1;

% Límite de la función objetivo
L 		= 30;

% Costes fijos de los enlaces de acceso.
% Fila i: Nodo de acceso i.
% Fila j: Nodo de núcleo j.
% ceAf(i,j) = Coste fijo del enlace entre nodo acceso i y nodo de núcleo j.
ceAf = [3 1 2 1 2 2 3 2; ...
        1 1 2 1 2 3 4 2; ...
        2 3 2 1 1 1 2 1; ...
        1 3 3 2 2 1 2 1; ...
        3 1 2 1 2 2 3 2; ...
        1 1 2 1 2 3 4 2; ...
        2 3 2 1 1 1 2 1; ...
        1 3 3 2 2 1 2 1; ...
        3 1 2 1 2 2 3 2; ...
        1 1 2 1 2 3 4 2; ...
        2 3 2 1 1 1 2 1; ...
        1 3 3 2 2 1 2 1; ...
        3 1 2 1 2 2 3 2; ...
        1 1 2 1 2 3 4 2; ...
        2 3 2 1 1 1 2 1; ...
        1 3 3 2 2 1 2 1; ...
        3 1 2 1 2 2 3 2; ...
        1 1 2 1 2 3 4 2; ...
        2 3 2 1 1 1 2 1; ...
        1 3 3 2 2 1 2 1]; 
    
% Costes variables de los enlaces de acceso.
% Fila i: Nodo de acceso i.
% Fila j: Nodo de núcleo j.
% ceAv(i,j) = Coste variable del enlace entre nodo acceso i y nodo de núcleo j.    
ceAv = [1 2 1 1 2 2 3 2; ...
        2 2 2 2 2 2 2 1; ...
        3 1 3 1 1 3 2 1; ...
        4 2 1 2 4 2 2 1; ...
        1 1 3 1 3 1 1 3; ...
        2 3 1 1 1 2 3 4; ...
        1 2 1 1 2 2 3 2; ...
        2 2 2 2 2 2 2 1; ...
        3 1 3 1 1 3 2 1; ...
        4 2 1 2 4 2 2 1; ...
        1 1 3 1 3 1 1 3; ...
        2 3 1 1 1 2 3 4; ...
        1 2 1 1 2 2 3 2; ...
        2 2 2 2 2 2 2 1; ...
        3 1 3 1 1 3 2 1; ...
        4 2 1 2 4 2 2 1; ...
        1 1 3 1 3 1 1 3; ...
        2 3 1 1 1 2 3 4; ...
        2 2 2 2 2 2 2 1; ...
        3 1 3 1 1 3 2 1];
    
% Costes fijos de los enlaces de núcleo.
% Fila i: Nodo de núcleo i.
% Fila j: Nodo de núcleo j.
% ceVf(i,j) = Coste fijo del enlace entre nodo de núcleo i y nodo de núcleo j.
% ceVf debe ser una matriz simétrica, de forma que ceVf(i,j) = ceVf(j,i).
ceVf = [0 2 2 3 2 1 1 1; ...
        2 0 2 3 1 2 3 1; ...
        2 2 0 1 1 3 3 2; ...
        3 3 1 0 2 2 2 2; ...
        2 1 1 2 0 3 2 1; ...
        1 2 3 2 3 0 1 3; ...
        1 3 3 2 2 1 0 1; ...
        1 1 2 2 1 3 1 0];

% Costes variables de los enlaces de núcleo.
% Fila i: Nodo de núcleo i.
% Fila j: Nodo de núcleo j.
% ceVv(i,j) = Coste fijo del enlace entre nodo de núcleo i y nodo de núcleo j.
% ceVv debe ser una matriz simétrica, de forma que ceVv(i,j) = ceVv(j,i).
ceVv = [0 2 1 2 1 1 1 2; ... 
        2 0 1 1 2 2 1 1; ...
        1 1 0 2 3 1 2 1; ...
        2 1 2 0 3 3 2 1; ...
        1 2 3 3 0 1 2 3; ...
        1 2 1 3 1 0 1 2; ...
        1 1 2 2 2 1 0 3; ...
        2 1 1 1 3 2 3 0];

ceAv = 8*ceAv;    
    
% Límite de uso de los enlaces de acceso.
% Fila i: Nodo de acceso i.
% Fila j: Nodo de núcleo j.
% MeA(i,j) = Límite de uso del enlace entre nodo acceso i y nodo de núcleo j.
MeA = [4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
% Fila i: Nodo de núcleo i.
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9; ...
       4 4 4 4 4 4 4 4; ...
       9 9 9 9 9 9 9 9];

% Límite de uso de los enlaces de núcleo.
% Fila j: Nodo de núcleo j.
% MeV debe ser una matriz simétrica, de forma que MeV(i,j) = MeV(j,i).
MeV = [0 7 8 9 8 7 6 7; ...
% MeV(i,j) = Límite de uso del enlace entre nodo de núcleo i y nodo de núcleo j.
       7 0 9 8 7 6 7 8; ...
       8 9 0 7 8 9 7 6; ...
       9 8 7 0 6 7 8 9; ...
       8 7 8 6 0 7 8 9; ...
       7 6 9 7 7 0 8 8; ...
       6 7 7 8 8 8 0 9; ...
       7 8 6 9 9 8 9 0];

MeV = 20 * MeV;

Gv = 2 * Gv;

% Llamada a la función sal.
[Fbest, yeAcceso, yeNucleo, trayectos, flujos]= sal(A, V, h, ceAf, ceAv, ceVf, ceVv, vCostes, M, Gv, MeA, MeV, q, N, L);

% Mensajes de debug en el fichero debug.txt
% Solución en el fichero solucion.txt


                                                      


